# seq2ribo

Structure-aware integration of machine learning and simulation to predict ribosome location profiles from RNA sequences.

## Installation

### Prerequisites

- **Linux** (required for mamba-ssm)
- **NVIDIA GPU** with CUDA support
- **CUDA Toolkit** 11.8+ (check with `nvcc --version`)
- **Conda** package manager

### Quick Install

```bash
# Clone the repository
git clone https://github.com/Kingsford-Group/seq2ribo.git
cd seq2ribo

# Create conda environment
conda env create -f environment.yml

# Activate
conda activate seq2ribo

# Install mamba-ssm (compiles from source, ~5-10 min)
python -m pip install --no-build-isolation mamba-ssm causal-conv1d

# Install seq2ribo package
pip install -e .
```

### Verify Installation

```bash
python -c "import RNA; import mamba_ssm; import torch; print('All imports OK!')"
```

> **Note**: If your CUDA version differs from 11.8, edit `pytorch-cuda=11.8` in `environment.yml` to match your system.  
> See [INSTALL.md](INSTALL.md) for detailed troubleshooting.

## Usage

### Python API

```python
from seq2ribo import Seq2Ribo

# Initialize predictor
predictor = Seq2Ribo(cell_line="hek293", weights_dir="weights")

# Predict ribosome density
sequence = "AUGGCCAAGCUGAAG..."
results = predictor.predict(sequence, task="riboseq")
```

### Command Line

```bash
# Predict from sequence
python scripts/run_inference.py --seq "AUGGCC..." --cell-line hek293 --task riboseq

# Predict from FASTA
python scripts/run_inference.py --fasta input.fa --cell-line ipsc --output results.json
```

### Supported Tasks

| Task | Description | Output |
|------|-------------|--------|
| `riboseq` | Ribosome profiling | Per-codon counts |
| `te` | Translation efficiency | Scalar |
| `protein` | Protein expression | Scalar |

### Supported Cell Lines

- `hek293` - HEK293
- `lcl` - Lymphoblastoid Cell Line
- `rpe` - RPE-1
- `ipsc` - iPSC

## Project Structure

```
seq2ribo/
├── seq2ribo/          # Core package
│   ├── inference.py   # Main API
│   ├── models.py      # Neural network models
│   ├── simulation.py  # sTASEP simulation
│   └── geometry.py    # RNA structure features
├── scripts/           # CLI scripts
├── weights/           # Model checkpoints
├── tests/             # Test suite
└── environment.yml    # Conda environment
```

## License

## License

This software is licensed for **Academic or Non-Profit Organization Noncommercial Research Use Only**.

See the [LICENSE](LICENSE) file for the full terms.

**For commercial use or any use not permitted by the academic license, please contact the options below to discuss licensing:**
- Carl Kingsford (carlk@cs.cmu.edu)

## Citation

If you use seq2ribo in your research, please cite:

> Gun Kaynar, Carl Kingsford. (2026). **seq2ribo: Structure-aware integration of machine learning and simulation to predict ribosome location profiles from RNA sequences**. *bioRxiv*. doi: [10.64898/2026.02.08.700508v1](https://doi.org/10.64898/2026.02.08.700508v1)

@article {Kaynar2026.02.08.700508,
	author = {Kaynar, Gun and Kingsford, Carl},
	title = {seq2ribo: Structure-aware integration of machine learning and simulation to predict ribosome location profiles from RNA sequences},
	elocation-id = {2026.02.08.700508},
	year = {2026},
	doi = {10.64898/2026.02.08.700508},
	publisher = {Cold Spring Harbor Laboratory},
	abstract = {Motivation: Ribosome dynamics are vital in the process of protein expression. Current methods rely on ribosome profiling (Ribo-seq), RNA-seq profiles, and full genomic context. This restricts their use in de novo sequence design, like messenger RNA (mRNA) vaccines. Simulation-only approaches like the Totally Asymmetric Simple Exclusion Process (TASEP) oversimplify translation by focusing solely on codon elongation times. Results: We present seq2ribo, a hybrid simulation and machine learning framework that predicts ribosome A-site locations using only an mRNA sequence as input. Our method first employs a novel structure-aware TASEP (sTASEP), which models translation using a comprehensive set of fitted parameters that include codon wait times and structural features, such as local angles, base-pairing, and discrete positional buckets. The ribosome locations generated by sTASEP are then processed by a polisher model, which learns to refine the simulated ribosome distributions. seq2ribo provides high-fidelity predictions of ribosome locations across diverse cell types (iPSC, HEK293, LCL, and RPE-1), significantly outperforming baselines. When benchmarked against sequence-only Translatomer, seq2ribo achieves reductions in transcript-level error up to 35.8\%, while simultaneously attaining the highest Pearson and Spearman correlations in every cell line and reducing structural errors between 43.3\% and 97.3\%. By adding a task-specific head, seq2ribo achieves Spearman correlations up to 0.795 with experimental translation efficiency (TE) across several cell lines, and 0.689 with measured protein expression. By operating from sequence alone, seq2ribo provides a new tool for synthetic biology, enabling the rational design and optimization of mRNA sequences without the need for expression-level data or genomic context. Availability: seq2ribo is available at https://github.com/Kingsford-Group/seq2ribo. Contact: gkaynar@cs.cmu.edu, carlk@cs.cmu.edu. Supplementary information: Supplementary data are available.Competing Interest StatementC.K. is a co-founder of Ocean Genomics, Inc.U.S. National Science Foundation, https://ror.org/021nxhr62, III-2232121National Institutes of Health, R01HG012470},
	URL = {https://www.biorxiv.org/content/early/2026/02/09/2026.02.08.700508},
	eprint = {https://www.biorxiv.org/content/early/2026/02/09/2026.02.08.700508.full.pdf},
	journal = {bioRxiv}
}
